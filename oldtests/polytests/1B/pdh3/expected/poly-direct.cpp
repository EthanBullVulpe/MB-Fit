#include "poly-model.h"

namespace mb_system {

double poly_model::eval_direct(const double a[50], const double x[6])
{
    double p[50];
    p[0] = x[2] + x[1] + x[0];
    p[1] = x[5] + x[4] + x[3];

    p[2] = x[3]*x[4] + x[3]*x[5] + x[4]*x[5];
    p[3] = x[1]*x[5] + x[0]*x[3] + x[0]*x[4] + x[1]*x[3] + x[2]*x[5] + x[2]*x[4];
    p[4] = x[1]*x[4] + x[2]*x[3] + x[0]*x[5];
    p[5] = x[1]*x[1] + x[2]*x[2] + x[0]*x[0];
    p[6] = x[0]*x[1] + x[1]*x[2] + x[0]*x[2];
    p[7] = x[4]*x[4] + x[5]*x[5] + x[3]*x[3];

    p[8] = x[1]*x[1]*x[1] + x[0]*x[0]*x[0] + x[2]*x[2]*x[2];
    p[9] = x[3]*x[4]*x[4] + x[3]*x[3]*x[5] + x[3]*x[3]*x[4] + x[4]*x[4]*x[5] + x[3]*x[5]*x[5] + x[4]*x[5]*x[5];
    p[10] = x[1]*x[2]*x[3] + x[0]*x[2]*x[5] + x[0]*x[1]*x[5] + x[0]*x[1]*x[4] + x[0]*x[2]*x[3] + x[1]*x[2]*x[4];
    p[11] = x[0]*x[0]*x[1] + x[1]*x[2]*x[2] + x[0]*x[0]*x[2] + x[0]*x[2]*x[2] + x[0]*x[1]*x[1] + x[1]*x[1]*x[2];
    p[12] = x[0]*x[3]*x[3] + x[0]*x[4]*x[4] + x[2]*x[5]*x[5] + x[1]*x[3]*x[3] + x[2]*x[4]*x[4] + x[1]*x[5]*x[5];
    p[13] = x[0]*x[0]*x[5] + x[1]*x[1]*x[4] + x[2]*x[2]*x[3];
    p[14] = x[0]*x[4]*x[5] + x[2]*x[3]*x[5] + x[2]*x[3]*x[4] + x[1]*x[3]*x[4] + x[1]*x[4]*x[5] + x[0]*x[3]*x[5];
    p[15] = x[0]*x[3]*x[4] + x[1]*x[3]*x[5] + x[2]*x[4]*x[5];
    p[16] = x[3]*x[3]*x[3] + x[4]*x[4]*x[4] + x[5]*x[5]*x[5];
    p[17] = x[2]*x[2]*x[4] + x[0]*x[0]*x[3] + x[2]*x[2]*x[5] + x[1]*x[1]*x[5] + x[0]*x[0]*x[4] + x[1]*x[1]*x[3];
    p[18] = x[0]*x[2]*x[4] + x[1]*x[2]*x[5] + x[0]*x[1]*x[3];
    p[19] = x[2]*x[3]*x[3] + x[0]*x[5]*x[5] + x[1]*x[4]*x[4];
    p[20] = x[3]*x[4]*x[5];
    p[21] = x[0]*x[1]*x[2];

    p[22] = x[2]*x[3]*x[3]*x[3] + x[1]*x[4]*x[4]*x[4] + x[0]*x[5]*x[5]*x[5];
    p[23] = x[3]*x[3]*x[3]*x[3] + x[4]*x[4]*x[4]*x[4] + x[5]*x[5]*x[5]*x[5];
    p[24] = x[0]*x[0]*x[0]*x[5] + x[1]*x[1]*x[1]*x[4] + x[2]*x[2]*x[2]*x[3];
    p[25] = x[0]*x[2]*x[3]*x[5] + x[0]*x[1]*x[4]*x[5] + x[1]*x[2]*x[3]*x[4];
    p[26] = x[0]*x[1]*x[2]*x[4] + x[0]*x[1]*x[2]*x[3] + x[0]*x[1]*x[2]*x[5];
    p[27] = x[1]*x[1]*x[1]*x[1] + x[2]*x[2]*x[2]*x[2] + x[0]*x[0]*x[0]*x[0];
    p[28] = x[3]*x[3]*x[5]*x[5] + x[3]*x[3]*x[4]*x[4] + x[4]*x[4]*x[5]*x[5];
    p[29] = x[0]*x[0]*x[1]*x[5] + x[0]*x[0]*x[2]*x[5] + x[0]*x[2]*x[2]*x[3] + x[1]*x[2]*x[2]*x[3] + x[1]*x[1]*x[2]*x[4] + x[0]*x[1]*x[1]*x[4];
    p[30] = x[0]*x[2]*x[3]*x[3] + x[0]*x[2]*x[5]*x[5] + x[1]*x[2]*x[3]*x[3] + x[0]*x[1]*x[5]*x[5] + x[0]*x[1]*x[4]*x[4] + x[1]*x[2]*x[4]*x[4];
    p[31] = x[0]*x[2]*x[4]*x[5] + x[0]*x[1]*x[3]*x[5] + x[0]*x[1]*x[3]*x[4] + x[1]*x[2]*x[4]*x[5] + x[0]*x[2]*x[3]*x[4] + x[1]*x[2]*x[3]*x[5];
    p[32] = x[1]*x[5]*x[5]*x[5] + x[1]*x[3]*x[3]*x[3] + x[0]*x[4]*x[4]*x[4] + x[2]*x[5]*x[5]*x[5] + x[0]*x[3]*x[3]*x[3] + x[2]*x[4]*x[4]*x[4];
    p[33] = x[0]*x[1]*x[1]*x[1] + x[0]*x[0]*x[0]*x[2] + x[1]*x[1]*x[1]*x[2] + x[1]*x[2]*x[2]*x[2] + x[0]*x[2]*x[2]*x[2] + x[0]*x[0]*x[0]*x[1];
    p[34] = x[2]*x[3]*x[4]*x[5] + x[0]*x[3]*x[4]*x[5] + x[1]*x[3]*x[4]*x[5];
    p[35] = x[3]*x[4]*x[4]*x[4] + x[4]*x[5]*x[5]*x[5] + x[4]*x[4]*x[4]*x[5] + x[3]*x[3]*x[3]*x[4] + x[3]*x[3]*x[3]*x[5] + x[3]*x[5]*x[5]*x[5];
    p[36] = x[1]*x[4]*x[4]*x[5] + x[2]*x[3]*x[3]*x[4] + x[2]*x[3]*x[3]*x[5] + x[0]*x[4]*x[5]*x[5] + x[1]*x[3]*x[4]*x[4] + x[0]*x[3]*x[5]*x[5];
    p[37] = x[3]*x[3]*x[4]*x[5] + x[3]*x[4]*x[4]*x[5] + x[3]*x[4]*x[5]*x[5];
    p[38] = x[0]*x[3]*x[3]*x[5] + x[2]*x[3]*x[5]*x[5] + x[0]*x[4]*x[4]*x[5] + x[1]*x[4]*x[5]*x[5] + x[1]*x[3]*x[3]*x[4] + x[2]*x[3]*x[4]*x[4];
    p[39] = x[0]*x[1]*x[1]*x[5] + x[1]*x[1]*x[2]*x[3] + x[1]*x[2]*x[2]*x[4] + x[0]*x[0]*x[2]*x[3] + x[0]*x[0]*x[1]*x[4] + x[0]*x[2]*x[2]*x[5];
    p[40] = x[0]*x[1]*x[1]*x[2] + x[0]*x[0]*x[1]*x[2] + x[0]*x[1]*x[2]*x[2];
    p[41] = x[0]*x[3]*x[3]*x[4] + x[0]*x[3]*x[4]*x[4] + x[1]*x[3]*x[5]*x[5] + x[2]*x[4]*x[4]*x[5] + x[2]*x[4]*x[5]*x[5] + x[1]*x[3]*x[3]*x[5];
    p[42] = x[0]*x[0]*x[1]*x[3] + x[1]*x[1]*x[2]*x[5] + x[0]*x[1]*x[1]*x[3] + x[1]*x[2]*x[2]*x[5] + x[0]*x[0]*x[2]*x[4] + x[0]*x[2]*x[2]*x[4];
    p[43] = x[2]*x[2]*x[5]*x[5] + x[1]*x[1]*x[5]*x[5] + x[0]*x[0]*x[4]*x[4] + x[0]*x[0]*x[3]*x[3] + x[2]*x[2]*x[4]*x[4] + x[1]*x[1]*x[3]*x[3];
    p[44] = x[2]*x[2]*x[4]*x[5] + x[0]*x[0]*x[3]*x[4] + x[1]*x[1]*x[3]*x[5];
    p[45] = x[1]*x[1]*x[1]*x[5] + x[2]*x[2]*x[2]*x[4] + x[1]*x[1]*x[1]*x[3] + x[2]*x[2]*x[2]*x[5] + x[0]*x[0]*x[0]*x[4] + x[0]*x[0]*x[0]*x[3];
    p[46] = x[2]*x[2]*x[3]*x[4] + x[2]*x[2]*x[3]*x[5] + x[0]*x[0]*x[3]*x[5] + x[0]*x[0]*x[4]*x[5] + x[1]*x[1]*x[3]*x[4] + x[1]*x[1]*x[4]*x[5];
    p[47] = x[0]*x[0]*x[2]*x[2] + x[1]*x[1]*x[2]*x[2] + x[0]*x[0]*x[1]*x[1];
    p[48] = x[1]*x[1]*x[4]*x[4] + x[2]*x[2]*x[3]*x[3] + x[0]*x[0]*x[5]*x[5];
    p[49] = x[0]*x[2]*x[4]*x[4] + x[0]*x[1]*x[3]*x[3] + x[1]*x[2]*x[5]*x[5];

    double energy(0);
    for(int i = 0; i < 50; ++i)
        energy += p[i]*a[i];

    return energy;

}
} // namespace mb_system