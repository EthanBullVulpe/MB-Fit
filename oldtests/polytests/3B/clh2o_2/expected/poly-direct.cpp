#include "poly-model.h"

namespace mb_system {

double poly_model::eval_direct(const double a[13], const double x[21])
{
    double p[13];

    p[0] = x[15]*x[18] + x[15]*x[17] + x[16]*x[17] + x[16]*x[18];
    p[1] = x[12]*x[15] + x[11]*x[18] + x[10]*x[17] + x[13]*x[16];
    p[2] = x[11]*x[15] + x[13]*x[17] + x[12]*x[17] + x[13]*x[18] + x[12]*x[18] + x[10]*x[15] + x[11]*x[16] + x[10]*x[16];
    p[3] = x[15]*x[8] + x[15]*x[9] + x[18]*x[8] + x[16]*x[6] + x[16]*x[7] + x[18]*x[6] + x[17]*x[9] + x[17]*x[7];
    p[4] = x[11]*x[20] + x[13]*x[19] + x[10]*x[20] + x[12]*x[19];
    p[5] = x[16]*x[20] + x[18]*x[19] + x[15]*x[20] + x[17]*x[19];
    p[6] = x[12]*x[20] + x[13]*x[20] + x[10]*x[19] + x[11]*x[19];
    p[7] = x[13]*x[15] + x[10]*x[18] + x[11]*x[17] + x[12]*x[16];
    p[8] = x[14]*x[20] + x[14]*x[19];
    p[9] = x[19]*x[8] + x[20]*x[7] + x[20]*x[6] + x[20]*x[8] + x[19]*x[6] + x[20]*x[9] + x[19]*x[7] + x[19]*x[9];
    p[10] = x[14]*x[15] + x[14]*x[18] + x[14]*x[17] + x[14]*x[16];
    p[11] = x[17]*x[8] + x[17]*x[6] + x[15]*x[6] + x[18]*x[9] + x[15]*x[7] + x[18]*x[7] + x[16]*x[9] + x[16]*x[8];
    p[12] = x[19]*x[20];

    double energy(0);
    for(int i = 0; i < 13; ++i)
        energy += p[i]*a[i];

    return energy;

}
} // namespace mb_system