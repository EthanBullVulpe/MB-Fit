#include "poly-model.h"

namespace mb_system {

double poly_model::eval_direct(const double a[53], const double x[45])
{
    double p[53];
    p[0] = x[35] + x[41] + x[38] + x[44] + x[32];
    p[1] = x[26] + x[29];
    p[2] = x[30] + x[42] + x[43] + x[40] + x[33] + x[31] + x[39] + x[34] + x[37] + x[36];
    p[3] = x[28] + x[24] + x[25] + x[27];

    p[4] = x[16]*x[42] + x[11]*x[39] + x[18]*x[31] + x[11]*x[43] + x[11]*x[36] + x[18]*x[34] + x[13]*x[36] + x[20]*x[33] + x[16]*x[37] + x[19]*x[30] + x[17]*x[40] + x[16]*x[30] + x[13]*x[43] + x[17]*x[30] + x[18]*x[33] + x[15]*x[43] + x[12]*x[43] + x[19]*x[39] + x[16]*x[43] + x[13]*x[42] + x[19]*x[31] + x[14]*x[40] + x[12]*x[42] + x[19]*x[33] + x[12]*x[33] + x[14]*x[36] + x[20]*x[31] + x[11]*x[40] + x[16]*x[31] + x[12]*x[34] + x[16]*x[36] + x[15]*x[30] + x[11]*x[37] + x[13]*x[33] + x[13]*x[34] + x[20]*x[37] + x[17]*x[37] + x[19]*x[34] + x[19]*x[40] + x[20]*x[30] + x[14]*x[39] + x[15]*x[40] + x[12]*x[39] + x[12]*x[40] + x[15]*x[42] + x[17]*x[36] + x[20]*x[34] + x[14]*x[33] + x[11]*x[42] + x[15]*x[39] + x[13]*x[37] + x[14]*x[34] + x[20]*x[36] + x[18]*x[42] + x[18]*x[30] + x[17]*x[31] + x[17]*x[39] + x[14]*x[37] + x[15]*x[31] + x[18]*x[43];
    p[5] = x[23]*x[34] + x[23]*x[40] + x[23]*x[43] + x[22]*x[30] + x[22]*x[42] + x[22]*x[39] + x[22]*x[33] + x[22]*x[36] + x[23]*x[37] + x[23]*x[31];
    p[6] = x[37]*x[8] + x[39]*x[4] + x[31]*x[6] + x[1]*x[30] + x[36]*x[3] + x[2]*x[34] + x[33]*x[7] + x[36]*x[8] + x[1]*x[31] + x[40]*x[4] + x[30]*x[6] + x[43]*x[5] + x[10]*x[42] + x[40]*x[9] + x[37]*x[3] + x[34]*x[7] + x[39]*x[9] + x[2]*x[33] + x[10]*x[43] + x[42]*x[5];
    p[7] = x[42]*x[42] + x[33]*x[33] + x[36]*x[36] + x[30]*x[30] + x[39]*x[39] + x[43]*x[43] + x[31]*x[31] + x[40]*x[40] + x[37]*x[37] + x[34]*x[34];
    p[8] = x[25]*x[34] + x[27]*x[39] + x[25]*x[40] + x[25]*x[37] + x[28]*x[31] + x[28]*x[43] + x[28]*x[37] + x[28]*x[40] + x[25]*x[43] + x[25]*x[31] + x[24]*x[30] + x[27]*x[36] + x[28]*x[34] + x[24]*x[42] + x[24]*x[39] + x[27]*x[42] + x[24]*x[36] + x[27]*x[30] + x[27]*x[33] + x[24]*x[33];
    p[9] = x[28]*x[2] + x[27]*x[4] + x[24]*x[7] + x[24]*x[9] + x[28]*x[5] + x[10]*x[25] + x[28]*x[3] + x[1]*x[28] + x[25]*x[7] + x[10]*x[24] + x[1]*x[27] + x[27]*x[2] + x[27]*x[3] + x[27]*x[5] + x[28]*x[4] + x[25]*x[6] + x[25]*x[9] + x[24]*x[8] + x[24]*x[6] + x[25]*x[8];
    p[10] = x[1]*x[24] + x[1]*x[25] + x[24]*x[4] + x[25]*x[5] + x[28]*x[9] + x[27]*x[8] + x[28]*x[8] + x[10]*x[28] + x[25]*x[2] + x[27]*x[7] + x[25]*x[4] + x[27]*x[6] + x[28]*x[7] + x[10]*x[27] + x[24]*x[3] + x[24]*x[5] + x[27]*x[9] + x[25]*x[3] + x[28]*x[6] + x[24]*x[2];
    p[11] = x[37]*x[41] + x[40]*x[44] + x[31]*x[38] + x[31]*x[41] + x[33]*x[38] + x[32]*x[43] + x[35]*x[43] + x[33]*x[41] + x[30]*x[35] + x[31]*x[35] + x[35]*x[39] + x[39]*x[44] + x[34]*x[41] + x[41]*x[43] + x[30]*x[41] + x[34]*x[38] + x[34]*x[44] + x[32]*x[40] + x[32]*x[42] + x[37]*x[44] + x[32]*x[33] + x[38]*x[42] + x[30]*x[44] + x[32]*x[39] + x[30]*x[38] + x[35]*x[36] + x[36]*x[44] + x[36]*x[41] + x[35]*x[42] + x[32]*x[34] + x[41]*x[42] + x[38]*x[43] + x[38]*x[39] + x[31]*x[44] + x[32]*x[37] + x[38]*x[40] + x[35]*x[37] + x[35]*x[40] + x[32]*x[36] + x[33]*x[44];
    p[12] = x[26]*x[8] + x[29]*x[5] + x[29]*x[3] + x[10]*x[26] + x[29]*x[4] + x[1]*x[29] + x[29]*x[2] + x[26]*x[6] + x[26]*x[7] + x[26]*x[9];
    p[13] = x[16]*x[39] + x[15]*x[36] + x[19]*x[43] + x[17]*x[43] + x[20]*x[43] + x[14]*x[42] + x[17]*x[34] + x[18]*x[39] + x[16]*x[33] + x[12]*x[36] + x[14]*x[31] + x[18]*x[36] + x[11]*x[34] + x[13]*x[40] + x[16]*x[40] + x[19]*x[42] + x[20]*x[39] + x[18]*x[37] + x[14]*x[30] + x[20]*x[42] + x[19]*x[36] + x[13]*x[30] + x[11]*x[30] + x[11]*x[31] + x[17]*x[42] + x[16]*x[34] + x[11]*x[33] + x[19]*x[37] + x[14]*x[43] + x[17]*x[33] + x[20]*x[40] + x[15]*x[33] + x[13]*x[31] + x[15]*x[37] + x[12]*x[30] + x[18]*x[40] + x[12]*x[31] + x[13]*x[39] + x[12]*x[37] + x[15]*x[34];
    p[14] = x[24]*x[35] + x[25]*x[41] + x[25]*x[35] + x[24]*x[41] + x[25]*x[44] + x[25]*x[32] + x[28]*x[35] + x[27]*x[44] + x[28]*x[38] + x[27]*x[32] + x[27]*x[41] + x[28]*x[32] + x[24]*x[32] + x[28]*x[41] + x[24]*x[38] + x[28]*x[44] + x[27]*x[35] + x[27]*x[38] + x[24]*x[44] + x[25]*x[38];
    p[15] = x[36]*x[40] + x[30]*x[40] + x[30]*x[34] + x[34]*x[36] + x[33]*x[37] + x[37]*x[42] + x[33]*x[43] + x[31]*x[39] + x[31]*x[36] + x[36]*x[43] + x[40]*x[42] + x[37]*x[39] + x[39]*x[43] + x[30]*x[37] + x[34]*x[42] + x[33]*x[40] + x[31]*x[33] + x[31]*x[42] + x[34]*x[39] + x[30]*x[43];
    p[16] = x[20]*x[29] + x[12]*x[29] + x[17]*x[26] + x[16]*x[26] + x[14]*x[29] + x[18]*x[29] + x[16]*x[29] + x[13]*x[26] + x[14]*x[26] + x[13]*x[29] + x[17]*x[29] + x[19]*x[29] + x[20]*x[26] + x[11]*x[26] + x[19]*x[26] + x[18]*x[26] + x[12]*x[26] + x[15]*x[26] + x[11]*x[29] + x[15]*x[29];
    p[17] = x[41]*x[44] + x[32]*x[35] + x[35]*x[41] + x[35]*x[38] + x[32]*x[38] + x[35]*x[44] + x[32]*x[44] + x[32]*x[41] + x[38]*x[41] + x[38]*x[44];
    p[18] = x[14]*x[27] + x[16]*x[27] + x[15]*x[27] + x[15]*x[28] + x[19]*x[25] + x[13]*x[27] + x[11]*x[24] + x[15]*x[24] + x[20]*x[24] + x[17]*x[24] + x[13]*x[28] + x[12]*x[27] + x[17]*x[28] + x[20]*x[25] + x[16]*x[28] + x[19]*x[28] + x[16]*x[24] + x[11]*x[27] + x[13]*x[25] + x[18]*x[24] + x[14]*x[28] + x[20]*x[28] + x[18]*x[28] + x[17]*x[27] + x[16]*x[25] + x[11]*x[28] + x[11]*x[25] + x[15]*x[25] + x[19]*x[27] + x[12]*x[25] + x[12]*x[24] + x[14]*x[25] + x[12]*x[28] + x[18]*x[25] + x[14]*x[24] + x[13]*x[24] + x[18]*x[27] + x[19]*x[24] + x[17]*x[25] + x[20]*x[27];
    p[19] = x[30]*x[33] + x[33]*x[39] + x[31]*x[34] + x[31]*x[43] + x[37]*x[43] + x[34]*x[37] + x[31]*x[37] + x[30]*x[42] + x[30]*x[36] + x[36]*x[42] + x[36]*x[39] + x[31]*x[40] + x[33]*x[42] + x[34]*x[40] + x[39]*x[42] + x[37]*x[40] + x[34]*x[43] + x[30]*x[39] + x[40]*x[43] + x[33]*x[36];
    p[20] = x[36]*x[38] + x[30]*x[32] + x[43]*x[44] + x[34]*x[35] + x[31]*x[32] + x[37]*x[38] + x[42]*x[44] + x[33]*x[35] + x[40]*x[41] + x[39]*x[41];
    p[21] = x[0]*x[28] + x[0]*x[24] + x[0]*x[25] + x[0]*x[27];
    p[22] = x[0]*x[31] + x[0]*x[33] + x[0]*x[42] + x[0]*x[36] + x[0]*x[37] + x[0]*x[30] + x[0]*x[39] + x[0]*x[40] + x[0]*x[34] + x[0]*x[43];
    p[23] = x[29]*x[9] + x[26]*x[3] + x[29]*x[6] + x[26]*x[4] + x[10]*x[29] + x[29]*x[8] + x[29]*x[7] + x[26]*x[2] + x[26]*x[5] + x[1]*x[26];
    p[24] = x[33]*x[3] + x[34]*x[5] + x[39]*x[3] + x[31]*x[3] + x[2]*x[42] + x[39]*x[7] + x[2]*x[31] + x[34]*x[6] + x[43]*x[6] + x[2]*x[40] + x[31]*x[5] + x[3]*x[42] + x[43]*x[9] + x[39]*x[8] + x[30]*x[7] + x[33]*x[6] + x[33]*x[9] + x[31]*x[7] + x[39]*x[6] + x[34]*x[4] + x[40]*x[5] + x[10]*x[37] + x[30]*x[9] + x[10]*x[34] + x[2]*x[36] + x[43]*x[7] + x[3]*x[43] + x[30]*x[5] + x[2]*x[37] + x[37]*x[9] + x[1]*x[36] + x[1]*x[33] + x[36]*x[4] + x[1]*x[40] + x[10]*x[31] + x[1]*x[34] + x[31]*x[9] + x[30]*x[3] + x[1]*x[42] + x[36]*x[6] + x[40]*x[7] + x[40]*x[8] + x[37]*x[5] + x[39]*x[5] + x[33]*x[5] + x[36]*x[5] + x[1]*x[43] + x[37]*x[6] + x[10]*x[36] + x[31]*x[8] + x[42]*x[4] + x[31]*x[4] + x[42]*x[8] + x[42]*x[9] + x[37]*x[7] + x[1]*x[39] + x[36]*x[9] + x[2]*x[39] + x[2]*x[30] + x[42]*x[6] + x[33]*x[4] + x[33]*x[8] + x[36]*x[7] + x[43]*x[8] + x[10]*x[39] + x[10]*x[30] + x[34]*x[8] + x[3]*x[40] + x[2]*x[43] + x[10]*x[40] + x[37]*x[4] + x[30]*x[8] + x[42]*x[7] + x[43]*x[4] + x[40]*x[6] + x[1]*x[37] + x[34]*x[9] + x[10]*x[33] + x[34]*x[3] + x[30]*x[4];
    p[25] = x[13]*x[38] + x[11]*x[41] + x[13]*x[44] + x[18]*x[32] + x[16]*x[32] + x[17]*x[38] + x[16]*x[38] + x[14]*x[35] + x[14]*x[41] + x[11]*x[38] + x[20]*x[38] + x[20]*x[35] + x[12]*x[44] + x[15]*x[32] + x[17]*x[41] + x[12]*x[41] + x[19]*x[41] + x[15]*x[44] + x[14]*x[38] + x[17]*x[32] + x[15]*x[41] + x[19]*x[32] + x[18]*x[35] + x[18]*x[44] + x[11]*x[44] + x[16]*x[44] + x[19]*x[35] + x[12]*x[35] + x[13]*x[35] + x[20]*x[32];
    p[26] = x[27]*x[31] + x[28]*x[42] + x[25]*x[36] + x[27]*x[40] + x[24]*x[43] + x[27]*x[34] + x[24]*x[40] + x[24]*x[37] + x[25]*x[30] + x[28]*x[36] + x[27]*x[37] + x[25]*x[42] + x[25]*x[39] + x[25]*x[33] + x[28]*x[30] + x[28]*x[33] + x[24]*x[34] + x[24]*x[31] + x[27]*x[43] + x[28]*x[39];
    p[27] = x[26]*x[34] + x[29]*x[42] + x[26]*x[30] + x[26]*x[43] + x[26]*x[39] + x[29]*x[39] + x[26]*x[37] + x[26]*x[42] + x[26]*x[36] + x[29]*x[30] + x[29]*x[31] + x[29]*x[33] + x[29]*x[43] + x[29]*x[40] + x[26]*x[33] + x[29]*x[34] + x[29]*x[37] + x[26]*x[40] + x[26]*x[31] + x[29]*x[36];
    p[28] = x[21]*x[34] + x[21]*x[30] + x[21]*x[39] + x[21]*x[33] + x[21]*x[36] + x[21]*x[43] + x[21]*x[42] + x[21]*x[37] + x[21]*x[40] + x[21]*x[31];
    p[29] = x[38]*x[9] + x[10]*x[38] + x[44]*x[9] + x[32]*x[9] + x[44]*x[8] + x[3]*x[41] + x[38]*x[5] + x[1]*x[35] + x[32]*x[8] + x[10]*x[35] + x[44]*x[7] + x[32]*x[4] + x[10]*x[41] + x[2]*x[38] + x[41]*x[7] + x[1]*x[41] + x[2]*x[44] + x[32]*x[3] + x[32]*x[5] + x[2]*x[32] + x[44]*x[4] + x[35]*x[9] + x[38]*x[7] + x[35]*x[6] + x[3]*x[44] + x[1]*x[44] + x[1]*x[38] + x[44]*x[6] + x[41]*x[5] + x[35]*x[5] + x[32]*x[7] + x[38]*x[6] + x[2]*x[41] + x[35]*x[3] + x[41]*x[8] + x[41]*x[6] + x[35]*x[4] + x[38]*x[4] + x[35]*x[8] + x[10]*x[32];
    p[30] = x[15]*x[35] + x[12]*x[38] + x[16]*x[35] + x[14]*x[44] + x[11]*x[35] + x[12]*x[32] + x[17]*x[44] + x[13]*x[41] + x[11]*x[32] + x[18]*x[38] + x[20]*x[41] + x[19]*x[38] + x[19]*x[44] + x[13]*x[32] + x[17]*x[35] + x[20]*x[44] + x[16]*x[41] + x[15]*x[38] + x[14]*x[32] + x[18]*x[41];
    p[31] = x[0]*x[38] + x[0]*x[41] + x[0]*x[32] + x[0]*x[35] + x[0]*x[44];
    p[32] = x[23]*x[26] + x[22]*x[26] + x[22]*x[29] + x[23]*x[29];
    p[33] = x[21]*x[24] + x[21]*x[25] + x[21]*x[28] + x[21]*x[27];
    p[34] = x[22]*x[41] + x[22]*x[32] + x[22]*x[38] + x[23]*x[41] + x[23]*x[35] + x[22]*x[35] + x[23]*x[38] + x[23]*x[32] + x[23]*x[44] + x[22]*x[44];
    p[35] = x[33]*x[34] + x[42]*x[43] + x[39]*x[40] + x[30]*x[31] + x[36]*x[37];
    p[36] = x[44]*x[44] + x[38]*x[38] + x[41]*x[41] + x[32]*x[32] + x[35]*x[35];
    p[37] = x[38]*x[3] + x[35]*x[7] + x[1]*x[32] + x[41]*x[4] + x[44]*x[5] + x[38]*x[8] + x[41]*x[9] + x[2]*x[35] + x[32]*x[6] + x[10]*x[44];
    p[38] = x[0]*x[26] + x[0]*x[29];
    p[39] = x[26]*x[38] + x[29]*x[35] + x[29]*x[44] + x[29]*x[38] + x[29]*x[32] + x[29]*x[41] + x[26]*x[32] + x[26]*x[44] + x[26]*x[35] + x[26]*x[41];
    p[40] = x[24]*x[27] + x[25]*x[28];
    p[41] = x[21]*x[26] + x[21]*x[29];
    p[42] = x[23]*x[42] + x[22]*x[31] + x[23]*x[30] + x[23]*x[39] + x[22]*x[43] + x[22]*x[40] + x[23]*x[33] + x[22]*x[37] + x[22]*x[34] + x[23]*x[36];
    p[43] = x[21]*x[38] + x[21]*x[35] + x[21]*x[41] + x[21]*x[44] + x[21]*x[32];
    p[44] = x[27]*x[29] + x[24]*x[26] + x[28]*x[29] + x[25]*x[26];
    p[45] = x[26]*x[26] + x[29]*x[29];
    p[46] = x[26]*x[28] + x[25]*x[29] + x[24]*x[29] + x[26]*x[27];
    p[47] = x[22]*x[24] + x[23]*x[28] + x[22]*x[27] + x[23]*x[25];
    p[48] = x[27]*x[27] + x[24]*x[24] + x[25]*x[25] + x[28]*x[28];
    p[49] = x[22]*x[25] + x[23]*x[27] + x[23]*x[24] + x[22]*x[28];
    p[50] = x[26]*x[29];
    p[51] = x[24]*x[28] + x[25]*x[27];
    p[52] = x[24]*x[25] + x[27]*x[28];

    double energy(0);
    for(int i = 0; i < 53; ++i)
        energy += p[i]*a[i];

    return energy;

}
} // namespace mb_system